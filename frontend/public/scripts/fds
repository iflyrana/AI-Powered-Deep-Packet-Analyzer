async function fetchPacketData() {
    try {
        const response = await fetch('http://10.76.8.5:5000/fetch-data'); // Use correct IP
        const data = await response.json();
        console.log("Fetched Data:", data); // Debugging log
        updateCharts(data);
    } catch (error) {
        console.error("Error fetching data:", error);
    }
}

function updateCharts(data) {
    // Extract normal and anomaly counts from the array
    let normalCount = 0;
    let anomalyCount = 0;

    data.forEach(entry => {
        if (entry.field === "normal_count") {
            normalCount = entry.value;
        } else if (entry.field === "anomaly_count") {
            anomalyCount = entry.value;
        }
    });

    console.log("Normal Count:", normalCount, "Anomaly Count:", anomalyCount); // Debugging log

    // Ensure `normalAnomalyChart` exists before updating
    if (typeof normalAnomalyChart !== "undefined") {
        normalAnomalyChart.data.datasets[0].data = [normalCount, anomalyCount];
        normalAnomalyChart.update();
    } else {
        console.warn("Chart object not initialized!");
    }
}

// Fetch data every 5 seconds
setInterval(fetchPacketData, 5000);
